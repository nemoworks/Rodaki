## 2021-09-28
### 进展
+ 前端：
  + 实现了车辆、门架弹出气泡显示json格式属性
  + 实现了时间轴拖动展示车辆预估轨迹中的位置
+ 后端：
  + 验证：ditto 端 prefetch 值改为50、100能够提升大约30%左右（1小时=>40分钟）
  + 没有找到ditto中支持属性依赖计算的方式
  + 暂时没找到ditto多线程并行如何确保状态保续的实现原理
### 问题
+ 后端：
  + 无法在ditto实现属性依赖计算
### 计划
+ 后端
  + 在flink和ditto之间引入couchdb。couchdb接收从flink发来的实体状态信息并保存，并提供属性依赖计算的算子以计算实体其他（依赖于其他属性状态的）属性的状态。当实体属性状态发生（明显）更新，通过rabbitmq通知ditto

## 2021-10-08
### 进展
+ 前端：
+ 后端：

### 问题
+ 后端：
  + couchDB性能不能满足需求
  + 车辆数据问题（待核实）
### 计划
+ 后端
  + 将CouchDB换为MongoDB
  + 尽快合适车辆数据问题（得知错误数据来源：非交易流水或者交易失败的流水车牌号可能会填成0，以及107、1111111、112、2653、8956、999999999等）

## 2021-10-15
### 进展
+ 前端：
+ 后端：mongodb 联通并验证，1小时数据需要10分钟左右保存; 熟悉mongodb API

### 问题
+ 后端：
### 计划
+ 后端
  + 将目前单个Collection 划分为多个Collection
  + 打通MongoDB change stream 向RabbitMQ发送消息以通知ditto; 尝试实现车辆平均车速计算
 
## 2021-10-19
### 进展
+ 前端：
+ 后端：单个Collection 划分为多个Collection; 打通 mongodb change stream API 向RabbitMQ发送消息

### 问题
+ 后端：
### 计划
+ 后端
  + 尝试基于MongoDB aggregation实现车辆平均车速计算、门架通过车辆统计
  + 尝试通过高德API爬取门架距离信息。基于数据集中已有轨迹，确定所需门架对，再进一步爬取距离信息（满足当前需要）。  

## 2021-10-22
### 进展
+ 前端：
+ 后端：
### 问题
+ 后端：
  + 计算门架通行数据的方案垮了多个collection，存在潜在的性能问题。
  + 当前数据模型和实际系统的易操作性存在gap（例如，不能直接获取门架记录中的车辆id）
  + 数据不一致：mongodb数据库中部分车辆的行驶记录不全或缺失。
### 计划
+ 后端
  + 尝试基于MongoDB aggregation实现车辆平均车速计算、门架通过车辆统计。两种实现方式考虑：、
   + 每次都利用aggregate查询统计（担心效率）
   + 通过时间窗口（限定最小窗口），事先计算好，使用时直接查询  
  + 尝试通过高德API爬取门架距离信息。基于数据集中已有轨迹，确定所需门架对，再进一步爬取距离信息（满足当前需要）。  
